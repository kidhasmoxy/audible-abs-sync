services:
  audible-abs-sync:
    build: .
    image: audible-abs-sync:latest
    container_name: audible_abs_sync
    restart: unless-stopped
    volumes:
      - ./data:/data
    environment:
      # Audiobookshelf Configuration
      - ABS_BASE_URL=http://your-abs-server-url
      - ABS_TOKEN=your-abs-api-token-here
      # - ABS_USER_ID=  # Optional, auto-detected if empty
      # - ABS_LIBRARY_ID=  # Optional, limit sync to specific library UUID

      # Audible Configuration
      - AUDIBLE_LOCALE=us
      # Generate this file using the command in README.md
      - AUDIBLE_AUTH_JSON_PATH=/data/audible_session.json
      
      # Sync Configuration
      - SYNC_INTERVAL_SECONDS=120
      - LOG_LEVEL=INFO
      - DRY_RUN=false
      
      # HTTP Server (Optional)
      - HTTP_SERVER_ENABLED=true
      - HTTP_SERVER_PORT=8080
    
    # Healthcheck
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/healthz"]
      interval: 30s
      timeout: 10s
      retries: 3
